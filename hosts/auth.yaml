# Host configuration for auth
# Hetzner VPS — headless server running auth stack (Traefik, Authelia, Pi-hole, etc.)

host: auth
description: Headless Arch Linux VPS for authentication and networking services

# Enabled modules — minimal server profile, no GUI/desktop
enabled_modules:
  - git                      # Git configuration and identity setup
  - sudoers                  # Passwordless sudo for current user
  - shell-config             # ZSH configuration and dotfiles
  - tmux                     # Tmux terminal multiplexer with plugins
  - nvim-config              # Neovim config from remote repo
  - ssh                      # Secure SSH server with key-based auth
  - tailscale                # Tailscale VPN with Tailscale SSH

# Module processing mode
module_processing: parallel

# Host-specific packages (beyond what's in modules)
packages:
  - docker
  - docker-compose
  - lazydocker               # TUI for Docker
  - lynis                    # Security auditing
  - fail2ban                 # SSH brute-force protection
  - arch-audit               # Vulnerable package detection
  - curl                     # HTTP client
  - rsync                    # File sync
  - carapace-bin             # Multi-shell completions
  - nodejs-lts-jod           # Node.js LTS runtime
  - npm                      # Node package manager
  - claude-code              # Anthropic's Claude Code CLI
  - openai-codex             # OpenAI Codex CLI

# Exclude desktop/GUI/hardware packages from base and declared-packages
exclude:
  # Terminal emulators (base.yaml — headless, not needed)
  - ghostty
  - ghostty-shell-integration
  - alacritty
  # CachyOS desktop/hardware (base.yaml)
  - cachyos-kernel-manager
  - cachyos-snapper-support
  - cachyos-ananicy-rules
  - ananicy-cpp
  - xclip
  - snapper
  # Conflicts with existing iptables
  - iptables-nft
  # Desktop/GUI (declared-packages.yaml)
  - octopi
  - mako
  - wlogout
  - wlsunset
  - wtype
  - bemenu-wayland
  - meld
  - gnome-terminal
  - gnome-keyring
  - accountsservice
  - btrfs-assistant
  - fastfetch
  - vesktop-bin
  - webkit2gtk-4.1
  - xdg-desktop-portal-termfilechooser-hunkyburrito-git
  # Audio/video (not needed headless)
  - alsa-firmware
  - alsa-plugins
  - alsa-utils
  - gst-plugin-pipewire
  - gst-plugin-va
  - gst-plugins-good
  - wireplumber
  - pulsemixer
  - pipewire-jack
  # Printing (not needed on VPS)
  - cups
  - cups-filters
  - cups-pdf
  - foomatic-db
  - foomatic-db-engine
  - foomatic-db-gutenprint-ppds
  - foomatic-db-nonfree
  - foomatic-db-nonfree-ppds
  - foomatic-db-ppds
  - ghostscript
  - gsfonts
  - gutenprint
  # Hardware/boot (VPS — no local hardware management)
  - bluez-hid2hci
  - cpupower
  - efibootmgr
  - efitools
  - grub
  - grub-btrfs-support
  - grub-hook
  - hdparm
  - hwdetect
  - hwinfo
  - lvm2
  - mkinitcpio
  - modemmanager
  - usb_modeswitch
  - usbutils
  - vulkan-radeon
  - mesa-utils
  # Filesystem tools (VPS uses ext4, not btrfs/jfs/nilfs/f2fs)
  - btrfs-assistant
  - dosfstools
  - exfatprogs
  - f2fs-tools
  - fsarchiver
  - jfsutils
  - nilfs-utils
  # Networking tools (VPS uses systemd-networkd, not iwd/netctl)
  - dhclient
  - iwd
  - netctl
  - nfs-utils
  - wireless-regdb
  - nss-mdns
  - dnsmasq
  # Fonts (headless)
  - noto-color-emoji-fontconfig
  - noto-fonts-cjk
  - ttf-opensans
  # Desktop/dev tools not needed on server
  - ffmpegthumbnailer
  - tigervnc
  - python-dbus
  - nano
  - nano-syntax-highlighting
  - ccusage
  - gemini-cli
  - uv
  - just
  - socat
  - 7zip
  # CachyOS (VPS is stock Arch, no CachyOS repos)
  - linux-cachyos
  - linux-cachyos-headers
  - linux-firmware
  - cachyos-hooks
  - cachyos-keyring
  - cachyos-mirrorlist
  - cachyos-v3-mirrorlist
  - cachyos-v4-mirrorlist
  - cachyos-settings
  - cachyos-rate-mirrors
  - cachyos-zsh-config

# Configuration backup settings
config_backups:
  enabled: true
  max_backups: 5

# No system backups (VPS, no snapper/btrfs)
system_backups:
  enabled: false

# Settings
flatpak_scope: user
auto_prune: false
aur_helper: paru

# Services to enable
services:
  enabled:
    - docker                  # Docker for container stack
    - fail2ban                # SSH brute-force protection
  disabled: []

# Sudoers — passwordless sudo for wheel group (convenience on personal VPS)
sudoers:
  wheel_nopasswd: true
